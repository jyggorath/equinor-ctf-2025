a = 18446744073709551862
α = 115792089237316201600239092629181903022853076627057745643635536179347243697936
g = 3
n = 7
p = (a**n-1)//(a-1)
e = 0x1337deadbeef1337

assert is_prime(p)
assert pow(α, (p-1)//n, p) == a
R.<x> = PolynomialRing(FiniteField(p))

H = HyperellipticCurve(α*x^n,1,'u,v')
assert H.genus() == g
J = H.jacobian()
J = J(J.base_ring())


# The flag has to be a valid point on the curve
P = H.lift_x(Integer(int.from_bytes(b"EPT{flag_for_testing}", 'big')))
encrypted = e * J(P)
print(encrypted[0].list())
print(encrypted[1].list())

"""
[37591645601766195349914241190244587541126648045894370496224605285205051789795607044058331351759777461098164398507872, 31825584496706095821807938099201614630698246114642375148953595216939791581619471005478949323508227490535910661480600, 38070154357732543786398829210104835275871944922030673096683631338658551155399049387419283060209447466278551582717763, 1]
[21531145860198597476878989237755710606843064008828229889869373339271596611957323351613721272489730980549489312170394, 8261157019291686096998910330610725289103621846918848921362473394138486389948240100075107913867104846969233604431830, 12307880594487906245908563779709403748007966885981814022547160387211433226745858660170917861206356995209959276604903]
"""